# 3D_research

## Краткое описание проекта
Данный проект содержит результаты кластеризации и вычисления стилостатистики для группы лиц с психическими расстройствами.

## Описание структуры

1. [Демографические данные](#демографические-данные)
2. [Метрики кластеризации](#метрики-кластеризации)
3. [Пороговые значения метрик](#пороговые-значения-метрик)
    + [Пороги по группам](#пороги-по-группам)
    + [Метрики по группам](#метрики-по-группам)
5. [Стилостатистика](#стилостатистика)
    + [Контрольная группа](#папка-control_group)
    + [Группа лиц с психическими расстройствами](#папка-mental_disorders_group)

## Демографические данные
Таблица [demographic_data_mental_disorders_diagnostics.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/demographic_data_mental_disorders_diagnostics.xlsx) содержит демографические показатели респондентов, участовавших в исследовании.

Представленные данные состоят из следующих столбцов:
- **ID** — уникальный идентификационный номер респондента (PN для контрольной группы; PD для лиц с психическими расстройствами);
- **Группа** — столбец с тегом, указывающим на группу, к которой относится респондент ("норма"/"пациенты" соответственно);
- **Диагноз** — диагноз при наличии (для группы нормы указывается "нет");
- **Пол**— женский, мужской, other
- **Возраст** — количество полных лет;
- **Уровень образования**:
    - среднее;
    - незаконченное среднее специальное;
    - среднее специальное;
    - незаконченное высшее;
    - высшее;
    - ученая степень;
- **Количество лет образования**


## Метрики кластеризации
Таблица [clustering_metrics_mental_disorders_diagnostics.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/clustering_metrics_thresholds_mental_disorders_diagnostics.xlsx) содержит 3 листа:
1. **healthy** — результаты кластеризации для контрольной группы;
2. **PD** — результаты кластеризации для группы лиц с психическими расстройствами без разделения по типу расстройства;
3. **PD_sep_diagnoses** — результаты кластеризации для группы лиц с психическими расстройствами, поделенная согласно диагностированным нарушениям.

### Каждый лист содержит следующие столбцы:
  - **speakerID** — уникальный ID респондента (PN, PPN, TPN для контрольной группы; PD для группы лиц с психическими расстройствами);
  - **fileID** — уникальный ID задания с ID респондента и указанием на тип выполняемого задания (пример: PN-05-pers-1-party, где pers — задание рассказа личной истории, party — тематика личной истории);
  - **lemmas** — токенизированный, лемматизированный и кластеризованный ответ респондента (без знаков препинания); кластеры представлены в виде списков, объединенных в один список (один список = один ответ);
  - **Switch_number** — количество переключений между кластерами;
  - **Mean_cluster_size** — средний размер кластера (среднее количество слов, входящих в кластер);;
  - **Mean_distance** — среднее расстояние между центроидами кластеров (за центроид берется среднее значение векторов, находящихся в одном кластере);
  - **Silhouette_score** — среднее значение silhouette-score (метрика, отображающая, насколько близок объект к своему кластеру по сравнению с другими кластерами: чем больше значение данной метрики, тем ближе объект к своему собственному кластеру);
  - **Mean_cluster_t_score** — среднее значение t-score в кластере (метрика, отображающая насколько неслучайной является сила ассоциации между коллокатами; в качестве коллокатов берутся все последовательности из двух слов внутри одного кластера).

В конце каждого листа также расчитаны следующие статистические показатели по каждому из столбцов:
- среднее;
- стандартное отклонение;
- медиана.

***NB***: для PD_sep_diagnoses статистические показатели расчитаны для каждого расстройства отдельно.

## Пороговые значения метрик
Таблица [clustering_metrics_thresholds_mental_disorders_diagnostics.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/clustering_metrics_thresholds_mental_disorders_diagnostics.xlsx) содержит 2 листа:
1. [Пороги по группам](#пороги-по-группам)
2. [Метрики по группам](#метрики-по-группам)

### Пороги по группам
Данный лист содержит столбцы со следующими метриками (более подробно они описаны [здесь](#каждый-лист-содержит-следующие-столбцы):
+ Switch_number
+ Mean_cluster_size
+ Mean_distance
+ Silhouette_score
+ Mean_cluster_t_score

Сперва указаны средние значения этих метрик для контрольной группы (норма), а затем в разбивке по расстройствам следующие статистические показатели:
- Среднее  — среднее значение в этой группе по метрикам;
- Порог  — пороговые значения для каждой метрики, чтобы предсказать принадлежность к группе; оптимальный выбирался по значению Recall;
- Recall - полнота (какую долю объектов положительного класса из всех объектов положительного класса нашёл алгоритм при заданном пороге);
- Метрика для порога  — статистический параметр, с помощью которого определялся порог (J-индекс Юдена и сумма/разница между средним и стандартным отклонением метрики в контрольной группе).

### Метрики по группам
Данный лист содержит столбцы со следующими метриками (более подробно они описаны [здесь](#каждый-лист-содержит-следующие-столбцы):
+ Switch_number
+ Mean_cluster_size
+ Mean_distance
+ Silhouette_score
+ Mean_cluster_t_score

Для каждой метрики указаны значения
- Среднего
- Стандартного отклонения
- Медианы

Присутсвует разделение норма/не норма (где лица с психическими расстройствами противопоставлены контрольной группе), а также данные показатели подсчитаны в разбивке по каждому расстройству.

## Стилостатистика
Все результаты стилостатистического анализа расположены в папке [stylostatistics](https://github.com/KhomenkoAnna/3D_research/tree/main/stylostatistics).

### Папка control_group
Данная папка содержит результаты стилостатистического анализа для контрольной группы.

Таблица [control_statistics.xlsx](https://github.com/KhomenkoAnna/3D_research/tree/main/stylostatistics/control_group/control_statistics.xlsx) содержит 6 листов:
1. **average_sentence_lenth** — результаты подсчета средней длины предложения (в словах);
2. **average_word_lenth** — результаты подсчета средней длины слова (в буквах);
3. **Flash-Kincaid_readability** — результаты подсчета индекса удобочитаемости Флеша-Кинкейда ([Flesch–Kincaid readability tests](https://ling.hse.ru/news/490474121.html));
4. **Gunning_Fog_Index** — результаты подсчета идекса туманности Ганнинга ([Gunning fog index](https://ling.hse.ru/news/490474121.html));
5. **TTR** — результаты подсчета идекса лексического разнообразия ([Type Token Ratio](https://elib.utmn.ru/jspui/bitstream/ru-tsu/7382/1/humanitates_2020_1_20_34.pdf));
6. **coefficient_Pr_Qu_Ac_Din_Con** — результаты подсчета следующих коэффициентов:
  - коэффициента предметности (Pr) – отношение суммы существительных и местоимений к сумме прилагательных и глаголов. Этот коэффициент оценивает, насколько текст насыщен конкретными понятиями, терминами и предметными номинациями;
  - коэффициента качественности (Qu) – отношение суммы прилагательных и наречий к сумме глаголов и существительных. Этот коэффициент оценивает наличие в тексте качественных характеристик, выраженных через прилагательные;
  - коэффициента активности (Ac) – отношение суммы глаголов и глагольных форм к количеству слов в тексте. Этот коэффициент измеряет динамику текста, оценивая, насколько часто используются глаголы и другие части речи, выражающие действие;
  - коэффициента динамизма (Din) –  отношение суммы глаголов и глагольных форм к сумме существительных, прилагательных и местоимений. Динамизм текста характеризует темп и степень изменения событий или состояний в тексте;
  - коэффициента связности текста (Con) – отношение суммы предлогов и союзов к числу предложений. Этот коэффициент оценивает, насколько текст логически структурирован и как хорошо связаны между собой отдельные части текста, предложения и абзацы.

### Каждый лист содержит следующие столбцы:
  - **speakerID** — уникальный ID респондента (PN, PPN, TPN для контрольной группы; PD для группы лиц с психическими расстройствами);
  - **fileID** — уникальный ID задания с ID респондента и указанием на тип выполняемого задания (пример: PN-05-pers-1-party, где pers — задание рассказа личной истории, party — тематика личной истории);
  - **transcript** — транскриптция аудиозаписей респондентов;
  - столбец с результатами по метрике, название которой совпадает с названием листа.

В конце каждого листа также расчитано среднее значение метрики.

Таблица [control_keywords.xlsx](https://github.com/KhomenkoAnna/3D_research/tree/main/stylostatistics/control_group/control_keywords.xlsx) содержит 5 листов:
1. **LL** — ключевые слова, отобранные по метрике Log-Likelihood ;
2. **T-score** — ключевые слова, отобранные по метрике T-score;
3. **MI** — ключевые слова, отобранные по метрике Mutual Information (MI);
4. **Dice** — ключевые слова, отобранные по метрике Dice ;
5. **Frequency** — ключевые слова, отобранные по метрике Frequency Ratio.

### Каждый лист содержит следующие столбцы:
  - **Word** — ключевые слова;
  - столбец с результатами по метрике, название которой совпадает с названием листа.

Таблица [control_ngrams.xlsx](https://github.com/KhomenkoAnna/3D_research/tree/main/stylostatistics/control_group/control_ngrams.xlsx) содержит 4 листа:
1. **Bigrams** — нелемматизированные биграммы;
2. **Trigrams** — нелемматизированные триграммы;
3. **Lemmatized_Bigrams** — лемматизированные биграммы;
4. **Lemmatized_Trigrams** — лемматизированные триграммы.

### Каждый лист содержит следующие столбцы:
  - **Ngram** — n-граммы;
  - **Frequency** — частота встречаемости n-грамм.

Таблица [control_collocations.xlsx](https://github.com/KhomenkoAnna/3D_research/tree/main/stylostatistics/control_group/control_collocations.xlsx) содержит 2 листа:
1. **not_lem** — нелемматизированные коллокации для топ-20 ключевых слов по метрике T-score;
2. **lem** — лемматизированные коллокации для топ-20 ключевых слов по метрике T-score.

### Каждый лист содержит следующие столбцы:
  - **Word** — ключевые слова;
  - **Collocation** — коллокации;
  - **T-score** — значение T-score.

### Папка mental_disorders_group
Данная папка содержит результаты стилостатистического анализа для группы лиц с психическими расстройствами. Он содержит в себе несколько подпапок, в которых каждый стилостатистический показатель рассчитан в разбивке по расстройству, а также 4 таблицы ([md_collocations.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/stylostatistics/mental_disorders_group/md_collocations.xlsx), [md_keywords.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/stylostatistics/mental_disorders_group/md_keywords.xlsx), [md_ngrams.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/stylostatistics/mental_disorders_group/md_ngrams.xlsx), [md_statistics.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/stylostatistics/mental_disorders_group/md_statistics.xlsx)), в которых собрана информация по коллокациям, ключевым словам, n-граммам и статистике без разделения по расстройству.

#### Описание таблиц без разбивки по данным:
- Таблица [md_collocations.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/stylostatistics/mental_disorders_group/md_collocations.xlsx) содержит 2 листа:
    - **not_lem** — нелемматизированные коллокации для топ-20 ключевых слов по метрике T-score;
    - **lem** — лемматизированные коллокации для топ-20 ключевых слов по метрике T-score.
    Каждый лист содержит следующие столбцы:
      - **Word** — ключевые слова;
      - **Collocation** — коллокации;
      - **T-score** — значение T-score.

- Таблица [md_keywords.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/stylostatistics/mental_disorders_group/md_keywords.xlsx) содержит 5 листов:
    -  **LL** — ключевые слова, отобранные по метрике Log-Likelihood ;
    -  **T-score** — ключевые слова, отобранные по метрике T-score;
    -  **MI** — ключевые слова, отобранные по метрике Mutual Information (MI);
    -  **Dice** — ключевые слова, отобранные по метрике Dice;
    -  **Frequency** — ключевые слова, отобранные по метрике Frequency Ratio.

- Таблица [md_ngrams.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/stylostatistics/mental_disorders_group/md_ngrams.xlsx) содержит 4 листа:
    - **Bigrams** — нелемматизированные биграммы;
    - **Trigrams** — нелемматизированные триграммы;
    - **Lemmatized_Bigrams** — лемматизированные биграммы;
    - **Lemmatized_Trigrams** — лемматизированные триграммы.  
    Каждый лист содержит следующие столбцы:
      - **Ngram** — n-граммы;
      - **Frequency** — частота встречаемости n-грамм.

- Таблица [md_statistics.xlsx](https://github.com/KhomenkoAnna/3D_research/blob/main/stylostatistics/mental_disorders_group/md_statistics.xlsx) содержит 6 листов:
    - **average_sentence_lenth** — результаты подсчета средней длины предложения (в словах);
    - **average_word_lenth** — результаты подсчета средней длины слова (в буквах);
    - **Flash-Kincaid_readability** — результаты подсчета индекса удобочитаемости Флеша-Кинкейда ([Flesch–Kincaid readability tests](https://ling.hse.ru/news/490474121.html));
    - **Gunning_Fog_Index** — результаты подсчета идекса туманности Ганнинга ([Gunning fog index](https://ling.hse.ru/news/490474121.html));
    - **TTR** — результаты подсчета идекса лексического разнообразия ([Type Token Ratio](https://elib.utmn.ru/jspui/bitstream/ru-tsu/7382/1/humanitates_2020_1_20_34.pdf));
    - **coefficient_Pr_Qu_Ac_Din_Con** — результаты подсчета следующих коэффициентов:
      - коэффициента предметности (Pr) – отношение суммы существительных и местоимений к сумме прилагательных и глаголов. Этот коэффициент оценивает, насколько текст насыщен конкретными понятиями, терминами и предметными номинациями;
      - коэффициента качественности (Qu) – отношение суммы прилагательных и наречий к сумме глаголов и существительных. Этот коэффициент оценивает наличие в тексте качественных характеристик, выраженных через прилагательные;
      - коэффициента активности (Ac) – отношение суммы глаголов и глагольных форм к количеству слов в тексте. Этот коэффициент измеряет динамику текста, оценивая, насколько часто используются глаголы и другие части речи, выражающие действие;
      - коэффициента динамизма (Din) –  отношение суммы глаголов и глагольных форм к сумме существительных, прилагательных и местоимений. Динамизм текста характеризует темп и степень изменения событий или состояний в тексте;
      - коэффициента связности текста (Con) – отношение суммы предлогов и союзов к числу предложений. Этот коэффициент оценивает, насколько текст логически структурирован и как хорошо связаны между собой отдельные части текста, предложения и абзацы.
    Каждый лист содержит следующие столбцы:
      - **speakerID** — уникальный ID респондента (PN, PPN, TPN для контрольной группы; PD для группы лиц с психическими расстройствами);
      - **fileID** — уникальный ID задания с ID респондента и указанием на тип выполняемого задания (пример: PN-05-pers-1-party, где pers — задание рассказа личной истории, party — тематика личной истории);
      - **transcript** — транскриптция аудиозаписей респондентов;
      - столбец с результатами по метрике, название которой совпадает с названием листа.
    
    В конце каждого листа также расчитано среднее значение метрики.

**NB**: Разбитые по расстройствам таблицы организованы аналогичным образом. Для каждого расстройства созданы таблицы по каждому показателю (коллокации, ключевые слова, n-граммы и статистика) в соответствующей папке ([collocations](https://github.com/KhomenkoAnna/3D_research/tree/main/stylostatistics/mental_disorders_group/collocations), [keywords](https://github.com/KhomenkoAnna/3D_research/tree/main/stylostatistics/mental_disorders_group/keywords), [n_grams](https://github.com/KhomenkoAnna/3D_research/tree/main/stylostatistics/mental_disorders_group/n_grams) и [statistics](https://github.com/KhomenkoAnna/3D_research/tree/main/stylostatistics/mental_disorders_group/statistics) с описанными выше листами.
